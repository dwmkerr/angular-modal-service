!function(e){function n(o){if(l[o])return l[o].exports;var t=l[o]={exports:{},id:o,loaded:!1};return e[o].call(t.exports,t,t.exports,n),t.loaded=!0,t.exports}var l={};return n.m=e,n.c=l,n.p="",n(0)}([function(e,n){"use strict";var l=Function("return this")();l.__coverage__||(l.__coverage__={}),l=l.__coverage__,l["/Users/jamesb/Development/oss/angular-modal-service/src/angular-modal-service.js"]||(l["/Users/jamesb/Development/oss/angular-modal-service/src/angular-modal-service.js"]={path:"/Users/jamesb/Development/oss/angular-modal-service/src/angular-modal-service.js",s:{1:0,2:0,3:1,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0,14:0,15:0,16:0,17:0,18:0,19:0,20:0,21:0,22:0,23:0,24:0,25:0,26:0,27:0,28:0,29:0,30:0,31:0,32:0,33:0,34:0,35:0,36:0,37:0,38:0,39:0,40:0,41:0,42:0,43:0,44:0,45:0,46:0,47:1,48:0,49:0,50:0,51:0,52:1,53:0,54:0,55:0,56:0,57:0,58:0,59:0,60:0,61:0,62:0,63:0,64:0,65:0,66:0,67:0},b:{1:[0,0],2:[0,0],3:[0,0],4:[0,0],5:[0,0],6:[0,0],7:[0,0],8:[0,0],9:[0,0],10:[0,0],11:[0,0],12:[0,0],13:[0,0],14:[0,0],15:[0,0]},f:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0},fnMap:{1:{name:"(anonymous_1)",line:5,loc:{start:{line:6,column:2},end:{line:6,column:106}}},2:{name:"ModalService",line:7,loc:{start:{line:8,column:2},end:{line:8,column:26}}},3:{name:"getTemplate",line:14,loc:{start:{line:15,column:22},end:{line:15,column:54}}},4:{name:"(anonymous_4)",line:19,loc:{start:{line:21,column:16},end:{line:21,column:35}}},5:{name:"(anonymous_5)",line:21,loc:{start:{line:23,column:13},end:{line:23,column:29}}},6:{name:"appendChild",line:33,loc:{start:{line:35,column:22},end:{line:35,column:46}}},7:{name:"(anonymous_7)",line:41,loc:{start:{line:43,column:21},end:{line:43,column:39}}},8:{name:"(anonymous_8)",line:57,loc:{start:{line:60,column:14},end:{line:60,column:33}}},9:{name:"closeModal",line:116,loc:{start:{line:119,column:10},end:{line:119,column:45}}},10:{name:"(anonymous_10)",line:118,loc:{start:{line:121,column:21},end:{line:121,column:32}}},11:{name:"cleanUpClose",line:124,loc:{start:{line:128,column:10},end:{line:128,column:40}}},12:{name:"(anonymous_12)",line:130,loc:{start:{line:135,column:26},end:{line:135,column:38}}},13:{name:"(anonymous_13)",line:152,loc:{start:{line:159,column:20},end:{line:159,column:36}}}},statementMap:{1:{start:{line:3,column:0},end:{line:3,column:0}},2:{start:{line:5,column:0},end:{line:5,column:0}},3:{start:{line:8,column:2},end:{line:166,column:3}},4:{start:{line:10,column:4},end:{line:10,column:4}},5:{start:{line:15,column:4},end:{line:15,column:4}},6:{start:{line:16,column:6},end:{line:16,column:6}},7:{start:{line:17,column:6},end:{line:28,column:7}},8:{start:{line:18,column:8},end:{line:18,column:8}},9:{start:{line:19,column:13},end:{line:28,column:7}},10:{start:{line:20,column:8},end:{line:20,column:8}},11:{start:{line:22,column:12},end:{line:22,column:12}},12:{start:{line:24,column:12},end:{line:24,column:12}},13:{start:{line:27,column:8},end:{line:27,column:8}},14:{start:{line:29,column:6},end:{line:29,column:6}},15:{start:{line:35,column:4},end:{line:35,column:4}},16:{start:{line:36,column:6},end:{line:36,column:6}},17:{start:{line:37,column:6},end:{line:39,column:7}},18:{start:{line:38,column:8},end:{line:38,column:8}},19:{start:{line:40,column:6},end:{line:40,column:6}},20:{start:{line:43,column:4},end:{line:43,column:4}},21:{start:{line:46,column:6},end:{line:46,column:6}},22:{start:{line:49,column:6},end:{line:49,column:6}},23:{start:{line:52,column:6},end:{line:52,column:6}},24:{start:{line:53,column:6},end:{line:56,column:7}},25:{start:{line:54,column:8},end:{line:54,column:8}},26:{start:{line:55,column:8},end:{line:55,column:8}},27:{start:{line:59,column:6},end:{line:59,column:6}},28:{start:{line:63,column:10},end:{line:63,column:10}},29:{start:{line:64,column:10},end:{line:64,column:10}},30:{start:{line:72,column:10},end:{line:72,column:10}},31:{start:{line:73,column:10},end:{line:73,column:10}},32:{start:{line:75,column:10},end:{line:75,column:10}},33:{start:{line:81,column:10},end:{line:81,column:30}},34:{start:{line:81,column:30},end:{line:81,column:30}},35:{start:{line:85,column:10},end:{line:85,column:10}},36:{start:{line:86,column:10},end:{line:86,column:10}},37:{start:{line:87,column:10},end:{line:87,column:10}},38:{start:{line:90,column:10},end:{line:90,column:10}},39:{start:{line:91,column:10},end:{line:91,column:10}},40:{start:{line:93,column:10},end:{line:95,column:11}},41:{start:{line:94,column:12},end:{line:94,column:12}},42:{start:{line:98,column:10},end:{line:104,column:11}},43:{start:{line:100,column:12},end:{line:100,column:12}},44:{start:{line:103,column:12},end:{line:103,column:12}},45:{start:{line:107,column:10},end:{line:107,column:10}},46:{start:{line:117,column:10},end:{line:117,column:10}},47:{start:{line:119,column:10},end:{line:126,column:11}},48:{start:{line:120,column:12},end:{line:120,column:55}},49:{start:{line:120,column:55},end:{line:120,column:55}},50:{start:{line:121,column:12},end:{line:121,column:12}},51:{start:{line:123,column:14},end:{line:123,column:14}},52:{start:{line:128,column:10},end:{line:156,column:11}},53:{start:{line:131,column:12},end:{line:131,column:12}},54:{start:{line:134,column:12},end:{line:134,column:12}},55:{start:{line:137,column:22},end:{line:137,column:22}},56:{start:{line:140,column:22},end:{line:140,column:22}},57:{start:{line:145,column:22},end:{line:145,column:22}},58:{start:{line:146,column:22},end:{line:146,column:22}},59:{start:{line:147,column:22},end:{line:147,column:22}},60:{start:{line:148,column:22},end:{line:148,column:22}},61:{start:{line:149,column:22},end:{line:149,column:22}},62:{start:{line:150,column:22},end:{line:150,column:22}},63:{start:{line:151,column:22},end:{line:151,column:22}},64:{start:{line:155,column:12},end:{line:155,column:12}},65:{start:{line:160,column:10},end:{line:160,column:10}},66:{start:{line:163,column:6},end:{line:163,column:6}},67:{start:{line:168,column:2},end:{line:168,column:2}}},branchMap:{1:{line:16,type:"if",locations:[{start:{line:17,column:6},end:{line:17,column:6}},{start:{line:17,column:6},end:{line:17,column:6}}]},2:{line:18,type:"if",locations:[{start:{line:19,column:13},end:{line:19,column:13}},{start:{line:19,column:13},end:{line:19,column:13}}]},3:{line:35,type:"if",locations:[{start:{line:37,column:6},end:{line:37,column:6}},{start:{line:37,column:6},end:{line:37,column:6}}]},4:{line:51,type:"if",locations:[{start:{line:53,column:6},end:{line:53,column:6}},{start:{line:53,column:6},end:{line:53,column:6}}]},5:{line:60,type:"binary-expr",locations:[{start:{line:63,column:28},end:{line:63,column:28}},{start:{line:63,column:45},end:{line:63,column:27}}]},6:{line:78,type:"if",locations:[{start:{line:81,column:10},end:{line:81,column:10}},{start:{line:81,column:10},end:{line:81,column:10}}]},7:{line:90,type:"if",locations:[{start:{line:93,column:10},end:{line:93,column:10}},{start:{line:93,column:10},end:{line:93,column:10}}]},8:{line:90,type:"binary-expr",locations:[{start:{line:93,column:14},end:{line:93,column:14}},{start:{line:93,column:38},end:{line:93,column:10}}]},9:{line:95,type:"if",locations:[{start:{line:98,column:10},end:{line:98,column:10}},{start:{line:98,column:10},end:{line:98,column:10}}]},10:{line:117,type:"if",locations:[{start:{line:120,column:12},end:{line:120,column:12}},{start:{line:120,column:12},end:{line:120,column:12}}]},11:{line:117,type:"binary-expr",locations:[{start:{line:120,column:16},end:{line:120,column:16}},{start:{line:120,column:39},end:{line:120,column:12}}]},12:{line:127,type:"binary-expr",locations:[{start:{line:131,column:12},end:{line:131,column:12}},{start:{line:131,column:29},end:{line:131,column:12}}]},13:{line:132,type:"binary-expr",locations:[{start:{line:137,column:22},end:{line:137,column:22}},{start:{line:137,column:40},end:{line:137,column:22}}]},14:{line:135,type:"binary-expr",locations:[{start:{line:140,column:22},end:{line:140,column:22}},{start:{line:140,column:36},end:{line:140,column:22}}]},15:{line:150,type:"binary-expr",locations:[{start:{line:155,column:12},end:{line:155,column:12}},{start:{line:155,column:32},end:{line:155,column:12}}]}},code:["'use strict';","","let module = angular.module('angularModalService', []);","","module.factory('ModalService', ['$animate', '$document', '$compile', '$controller', '$http', '$rootScope', '$q', '$templateRequest', '$timeout',","  function($animate, $document, $compile, $controller, $http, $rootScope, $q, $templateRequest, $timeout) {","","  function ModalService() {","","    var self = this;","","    //  Returns a promise which gets the template, either","    //  from the template parameter or via a request to the","    //  template url parameter.","    var getTemplate = function(template, templateUrl) {","      var deferred = $q.defer();","      if (template) {","        deferred.resolve(template);","      } else if (templateUrl) {","        $templateRequest(templateUrl, true)","          .then(function(template) {","            deferred.resolve(template);","          }, function(error) {","            deferred.reject(error);","          });","      } else {",'        deferred.reject("No template or templateUrl has been specified.");',"      }","      return deferred.promise;","    };","","    //  Adds an element to the DOM as the last child of its container","    //  like append, but uses $animate to handle animations. Returns a","    //  promise that is resolved once all animation is complete.","    var appendChild = function(parent, child) {","      var children = parent.children();","      if (children.length > 0) {","        return $animate.enter(child, parent, children[children.length - 1]);","      }","      return $animate.enter(child, parent);","    };","","    self.showModal = function(options) {","","      //  Get the body of the document, we'll add the modal to this.","      var body = angular.element($document[0].body);","","      //  Create a deferred we'll resolve when the modal is ready.","      var deferred = $q.defer();","","      //  Validate the input parameters.","      var controllerName = options.controller;","      if (!controllerName) {",'        deferred.reject("No controller has been specified.");',"        return deferred.promise;","      }","","      //  Get the actual html of the template.","      getTemplate(options.template, options.templateUrl)","        .then(function(template) {","","          //  Create a new scope for the modal.","          var modalScope = (options.scope || $rootScope).$new();","          var rootScopeOnClose = $rootScope.$on('$locationChangeSuccess', cleanUpClose);","","          //  Create the inputs object to the controller - this will include","          //  the scope, as well as all inputs provided.","          //  We will also create a deferred that is resolved with a provided","          //  close function. The controller can then call 'close(result)'.","          //  The controller can also provide a delay for closing - this is","          //  helpful if there are closing animations which must finish first.","          var closeDeferred = $q.defer();","          var closedDeferred = $q.defer();","","          var inputs = {","            $scope: modalScope,","            close: closeModal","          };","","          //  If we have provided any inputs, pass them to the controller.","          if (options.inputs) angular.extend(inputs, options.inputs);","","          //  Compile then link the template element, building the actual element.","          //  Set the $element on the inputs so that it can be injected if required.","          var linkFn = $compile(template);","          var modalElement = linkFn(modalScope);","          inputs.$element = modalElement;","","          //  Create the controller, explicitly specifying the scope to use.","          var controllerObjBefore = modalScope[options.controllerAs];","          var modalController = $controller(options.controller, inputs, false, options.controllerAs);","","          if (options.controllerAs && controllerObjBefore) {","            angular.extend(modalController, controllerObjBefore);","          }","","          //  Finally, append the modal to the dom.","          if (options.appendElement) {","            // append to custom append element","            appendChild(options.appendElement, modalElement);","          } else {","            // append to body when no custom append element is specified","            appendChild(body, modalElement);","          }","","          //  We now have a modal object...","          var modal = {","            controller: modalController,","            scope: modalScope,","            element: modalElement,","            close: closeDeferred.promise,","            closed: closedDeferred.promise,","            closeModal: closeModal","          };","","          //  ...which is passed to the caller via the promise.","          deferred.resolve(modal);","","          function closeModal(result, delay) {","            if (delay === undefined || delay === null) delay = 0;","            $timeout(function() {","","              cleanUpClose(result);","","            }, delay);","          }","","          function cleanUpClose(result) {","","            //  Resolve the 'close' promise.","            closeDeferred && closeDeferred.resolve(result);","","            //  Let angular remove the element and wait for animations to finish.","            $animate.leave(modalElement)","                    .then(function () {","                      //  Resolve the 'closed' promise.","                      closedDeferred && closedDeferred.resolve(result);","","                      //  We can now clean up the scope","                      modalScope && modalScope.$destroy();","","                      //  Unless we null out all of these objects we seem to suffer","                      //  from memory leaks, if anyone can explain why then I'd","                      //  be very interested to know.","                      inputs.close = null;","                      deferred = null;","                      closeDeferred = null;","                      modal = null;","                      inputs = null;","                      modalElement = null;","                      modalScope = null;","                    });","","            // remove event watcher","            rootScopeOnClose && rootScopeOnClose();","          }","","        })","        .then(null, function(error) { // 'catch' doesn't work in IE8.","          deferred.reject(error);","        });","","      return deferred.promise;","    };","","  }","","  return new ModalService();","}]);",""]}),l=l["/Users/jamesb/Development/oss/angular-modal-service/src/angular-modal-service.js"],l.s[1]++;var o=angular.module("angularModalService",[]);l.s[2]++,o.factory("ModalService",["$animate","$document","$compile","$controller","$http","$rootScope","$q","$templateRequest","$timeout",function(e,n,o,t,r,i,c,a,s){function m(){l.f[2]++,l.s[4]++;var r=this;l.s[5]++;var m=function(e,n){l.f[3]++,l.s[6]++;var o=c.defer();return l.s[7]++,e?(l.b[1][0]++,l.s[8]++,o.resolve(e)):(l.b[1][1]++,l.s[9]++,n?(l.b[2][0]++,l.s[10]++,a(n,!0).then(function(e){l.f[4]++,l.s[11]++,o.resolve(e)},function(e){l.f[5]++,l.s[12]++,o.reject(e)})):(l.b[2][1]++,l.s[13]++,o.reject("No template or templateUrl has been specified."))),l.s[14]++,o.promise};l.s[15]++;var u=function(n,o){l.f[6]++,l.s[16]++;var t=n.children();return l.s[17]++,t.length>0?(l.b[3][0]++,l.s[18]++,e.enter(o,n,t[t.length-1])):(l.b[3][1]++,l.s[19]++,e.enter(o,n))};l.s[20]++,r.showModal=function(r){l.f[7]++,l.s[21]++;var a=angular.element(n[0].body);l.s[22]++;var d=c.defer();l.s[23]++;var p=r.controller;return l.s[24]++,p?(l.b[4][1]++,l.s[27]++,m(r.template,r.templateUrl).then(function(n){function m(e,n){l.f[9]++,l.s[48]++,l.b[11][0]++,void 0===n||(l.b[11][1]++,null===n)?(l.b[10][0]++,l.s[49]++,n=0):l.b[10][1]++,l.s[50]++,s(function(){l.f[10]++,l.s[51]++,p(e)},n)}function p(n){l.f[11]++,l.s[53]++,l.b[12][0]++,v&&(l.b[12][1]++,v.resolve(n)),l.s[54]++,e.leave(g).then(function(){l.f[12]++,l.s[55]++,l.b[13][0]++,b&&(l.b[13][1]++,b.resolve(n)),l.s[56]++,l.b[14][0]++,f&&(l.b[14][1]++,f.$destroy()),l.s[57]++,y.close=null,l.s[58]++,d=null,l.s[59]++,v=null,l.s[60]++,j=null,l.s[61]++,y=null,l.s[62]++,g=null,l.s[63]++,f=null}),l.s[64]++,l.b[15][0]++,h&&(l.b[15][1]++,h())}l.f[8]++,l.s[28]++;var f=(l.b[5][0]++,r.scope||(l.b[5][1]++,i)).$new();l.s[29]++;var h=i.$on("$locationChangeSuccess",p);l.s[30]++;var v=c.defer();l.s[31]++;var b=c.defer();l.s[32]++;var y={$scope:f,close:m};l.s[33]++,r.inputs?(l.b[6][0]++,l.s[34]++,angular.extend(y,r.inputs)):l.b[6][1]++,l.s[35]++;var $=o(n);l.s[36]++;var g=$(f);l.s[37]++,y.$element=g,l.s[38]++;var w=f[r.controllerAs];l.s[39]++;var S=t(r.controller,y,!1,r.controllerAs);l.s[40]++,l.b[8][0]++,r.controllerAs&&(l.b[8][1]++,w)?(l.b[7][0]++,l.s[41]++,angular.extend(S,w)):l.b[7][1]++,l.s[42]++,r.appendElement?(l.b[9][0]++,l.s[43]++,u(r.appendElement,g)):(l.b[9][1]++,l.s[44]++,u(a,g)),l.s[45]++;var j={controller:S,scope:f,element:g,close:v.promise,closed:b.promise,closeModal:m};l.s[46]++,d.resolve(j)}).then(null,function(e){l.f[13]++,l.s[65]++,d.reject(e)}),l.s[66]++,d.promise):(l.b[4][0]++,l.s[25]++,d.reject("No controller has been specified."),l.s[26]++,d.promise)}}return l.f[1]++,l.s[67]++,new m}])}]);
//# sourceMappingURL=./dst/angular-modal-service.min.js.map